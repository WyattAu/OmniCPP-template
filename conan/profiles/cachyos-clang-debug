# Conan profile for CachyOS (Clang debug)
# Reference: ADR-034-conan-profile-expansion.md
# Reference: ADR-028-cachyos-primary-linux-target.md
# Requirement: REQ-004-008
#
# Usage:
#   conan install . --profile cachyos-clang-debug
#   conan build . --profile cachyos-clang-debug
#
# This profile configures:
# - Clang 19 compiler (CachyOS default)
# - C++23 standard
# - Debug build type
# - Linux x86_64 architecture
# - libc++ C++ library (LLVM's C++ standard library)
# - CMake toolchain integration with Ninja generator
# - CachyOS-specific debug settings:
#   - -march=native: Optimize for host CPU architecture
#   - -g: Generate debug information
#   - -O0: No optimization for better debugging
#   - -DDEBUG: Enable debug-specific code paths
# - Security hardening flags (even in debug builds):
#   - -fstack-protector-strong: Stack protection against buffer overflows
#   - -D_FORTIFY_SOURCE=2: Runtime buffer overflow detection
# - Linker flags for security:
#   - --as-needed: Only link libraries that are actually used
#   - --no-undefined: Fail if any undefined symbols remain
#   - -z,relro: Relocation read-only after load
#   - -z,now: Bind all symbols at load time

[settings]
os=Linux
arch=x86_64
compiler=clang
compiler.version=19
compiler.libcxx=libc++
compiler.cppstd=23
build_type=Debug

[conf]
tools.cmake.cmaketoolchain:system_name=Linux
tools.cmake.cmaketoolchain:generator=Ninja
tools.build:compiler_executables={"c": "clang", "cpp": "clang++"}
tools.build:cxxflags=-march=native -g -O0 -DDEBUG -fstack-protector-strong -D_FORTIFY_SOURCE=2
tools.build:cflags=-march=native -g -O0 -DDEBUG -fstack-protector-strong -D_FORTIFY_SOURCE=2
tools.build:sharedlinkflags=-Wl,--as-needed -Wl,--no-undefined -Wl,-z,relro -Wl,-z,now
tools.build:exelinkflags=-Wl,--as-needed -Wl,--no-undefined -Wl,-z,relro -Wl,-z,now

[options]
vulkan/*:shared=True

[buildenv]
CC=clang
CXX=clang++
CFLAGS=-march=native -g -O0 -DDEBUG -fstack-protector-strong -D_FORTIFY_SOURCE=2
CXXFLAGS=-march=native -g -O0 -DDEBUG -fstack-protector-strong -D_FORTIFY_SOURCE=2
LDFLAGS=-Wl,--as-needed -Wl,--no-undefined -Wl,-z,relro -Wl,-z,now
